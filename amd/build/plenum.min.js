define("mod_plenum/plenum",["exports","core/fragment","core/templates","core_form/modalform","core/notification","core/str"],(function(_exports,_fragment,_templates,_modalform,_notification,_str){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/*
   * Plenary meeting main page js
   *
   * @package    mod_plenum
   * @module     mod_plenum/plenum
   * @copyright  2023 Daniel Thies
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_fragment=_interopRequireDefault(_fragment),_templates=_interopRequireDefault(_templates),_modalform=_interopRequireDefault(_modalform),_notification=_interopRequireDefault(_notification);_exports.default=class{constructor(contextid){return this.contextid=contextid,this.addListeners(),!0}addListeners(){document.querySelector("body").removeEventListener("click",handleClick),document.querySelector("body").addEventListener("click",handleClick)}};const handleClick=function(e){const button=e.target.closest('[data-region="plenum-motions"][data-contextid] [data-action], .modal-body [data-contextid] [data-action]');if(button){const action=button.getAttribute("data-action"),contextid=button.closest("[data-contextid]").getAttribute("data-contextid");if(e.stopPropagation(),e.preventDefault(),"move"==action){const type=button.getAttribute("data-type");new _modalform.default({args:{contextid:contextid,type:button.getAttribute("data-type")},formClass:`plenumtype_${type}\\form\\edit_motion`,modalConfig:{title:(0,_str.get_string)("editingmotiontype",`plenumtype_${type}`)}}).show()}else if(["adopt","allow","decline","deny"].includes(action)){const id=e.target.closest("[data-motion]").getAttribute("data-motion");new _modalform.default({args:{contextid:contextid,id:id,state:action},formClass:"mod_plenum\\form\\change_state",modalConfig:{title:(0,_str.get_string)("confirm")}}).show()}else if("close"==action){const id=e.target.closest("[data-motion]").getAttribute("data-motion");new _modalform.default({formClass:"mod_plenum\\form\\close_motion",args:{contextid:contextid,id:id,state:action}}).show()}else if("preview"==action){const id=e.target.closest("[data-motion]").getAttribute("data-motion");_fragment.default.loadFragment("mod_plenum","motion",contextid,{id:id}).done((html=>{button.closest(".modal-body")&&!button.closest('[data-region="plenum-activity-report"]')?_templates.default.replaceNodeContents(button.closest(".modal-body"),"<div>"+html+"</div>"):_notification.default.alert((0,_str.get_string)("viewmotion","mod_plenum"),html)})).fail(_notification.default.exeption)}}};return _exports.default}));

//# sourceMappingURL=plenum.min.js.map